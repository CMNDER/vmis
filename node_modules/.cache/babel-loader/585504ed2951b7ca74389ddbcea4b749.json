{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/home/samuel/vmis-1/src/Pages/Return.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { useInput } from '../Data/useInput';\nimport { Tabs, Tab, Button, Spinner } from 'react-bootstrap/';\nimport VaccineList from '../Components/VaccinesSelectDropDown';\nimport { constraintCheck } from '../Data/ConstraintCheck';\nimport { userIntelContext } from '../App';\nimport CardComponent from '../Components/CardComponent';\nlet returnList = [];\n\nconst Return = props => {\n  _s();\n\n  var config = {\n    method: 'get',\n    url: 'http://localhost:8765/api/return',\n    headers: {\n      'auth': localStorage.getItem('vmisJwt')\n    }\n  };\n  const user = useContext(userIntelContext);\n  const {\n    value: quantity,\n    bind: bindQuantity,\n    reset: resetQuantity\n  } = useInput('');\n  const {\n    value: batchNumber,\n    bind: bindBatchNumber,\n    reset: resetBatchNumber\n  } = useInput('');\n  const [disabled, setDisabled] = useState(false);\n  const [spin, setSpin] = useState('');\n  const [message, setMessage] = useState('');\n  const [Deleted, setDeleted] = useState(false);\n  const [returnMade, setReturnMade] = useState(0);\n  const [myStock, setMyStock] = useState(null);\n  const [selectedVaccine, setSelectedVaccine] = useState('');\n  const [inputError, setInputError] = useState(null);\n  useEffect(() => {\n    axios.get('http://localhost:8765/api/dispense', {\n      headers: config.headers\n    }).then(res => {\n      setMyStock(res.response.data);\n    }).catch(e => {\n      console.log(e);\n    });\n  }, [message]);\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    let quantityCheck = null;\n\n    for (const key in myStock) {\n      if (myStock.hasOwnProperty(key)) {\n        const element = myStock[key];\n\n        if (element.vaccineId === selectedVaccine.vaccineId) {\n          if (element.quantity < quantity) {\n            quantityCheck = 1;\n          }\n        }\n      }\n    }\n\n    if (!quantityCheck) {\n      if (constraintCheck(returnList, selectedVaccine.vaccineId, quantity)) {\n        returnList = constraintCheck(returnList, selectedVaccine.vaccineId, quantity);\n      } else {\n        returnList.push({\n          \"vaccineName\": selectedVaccine.vaccineName,\n          \"vaccineid\": selectedVaccine.vaccineId,\n          \"batchNumber\": batchNumber,\n          \"vaccineQuantity\": quantity\n        });\n      }\n\n      document.getElementById(\"vaccineSelectionDropdown\").value = \"\";\n      resetQuantity();\n      resetBatchNumber();\n    } else {\n      setInputError(\"quantity is greater than your stock\");\n    }\n  };\n\n  const deleteReturn = e => {\n    returnList.splice(e, 1);\n    setInterval(() => {\n      setDeleted(true);\n    }, 50);\n    setDeleted(false);\n  };\n\n  const handleApiSubmission = () => {\n    setSpin('border');\n    setDisabled(true);\n    const data = {\n      from_orgunitid: user.userToken.orgunit,\n      from_orgunitname: user.userToken.orgunitname,\n      to_orgunitid: user.userToken.parentorgunit,\n      to_orgunitname: user.userToken.parentorgunitname,\n      returnedItems: JSON.stringify(returnList)\n    };\n    axios.post(\"http://localhost:8765/api/return\", data, {\n      headers: {\n        'auth': localStorage.getItem('vmisJwt')\n      }\n    }).then(res => {\n      setDisabled(false);\n      setMessage('');\n      returnList.splice(0, returnList.length);\n      setSpin('');\n      setMessage({\n        message: 'Return was successfully',\n        type: 'text-center alert alert-success m-2'\n      });\n      setReturnMade(returnMade + 1);\n      setTimeout(() => {\n        setMessage('');\n      }, 3000);\n    }).catch(e => {\n      if (e.response.data) {\n        if (e.response.data[0].vaccine) {\n          for (const err in e.response.data) {\n            const error = e.response.data[err];\n            setMessage({\n              message: `Return failed ${error.vaccine} ${error.error} `,\n              type: 'text-center alert alert-danger m-2'\n            });\n          }\n        } else {\n          setMessage({\n            message: `Return failed `,\n            type: 'text-center alert alert-danger m-2'\n          });\n        }\n      }\n\n      setSpin('');\n      setDisabled(false);\n      setTimeout(() => {\n        setMessage('');\n      }, 5000);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n      className: \"card-header text-center\",\n      children: \"Return \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: message.type,\n      children: message.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container-fluid my-3\",\n      children: /*#__PURE__*/_jsxDEV(Tabs, {\n        defaultActiveKey: \"returns\",\n        transition: false,\n        id: \"noanim-tab-example\",\n        children: [/*#__PURE__*/_jsxDEV(Tab, {\n          eventKey: \"returns\",\n          title: \"Returns\",\n          children: /*#__PURE__*/_jsxDEV(CardComponent, {\n            dependency: returnMade,\n            config: config\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Tab, {\n          eventKey: \"returnForm\",\n          title: \"Return Form\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"container-fluid\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"row\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  children: \"Return Form\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 134,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n                  onSubmit: handleSubmit,\n                  children: [/*#__PURE__*/_jsxDEV(VaccineList, {\n                    onChange: value => setSelectedVaccine(value),\n                    disabled: disabled\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 136,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                      children: \"Batch Number:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 138,\n                      columnNumber: 45\n                    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"text\",\n                      className: \"form-control\",\n                      placeholder: \"Batch number\",\n                      ...bindBatchNumber,\n                      required: true,\n                      disabled: disabled\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 139,\n                      columnNumber: 45\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 137,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"form-group\",\n                    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                      children: \"Quantity:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 143,\n                      columnNumber: 45\n                    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"number\",\n                      className: \"form-control\",\n                      placeholder: \"Quantity to be returned\",\n                      ...bindQuantity,\n                      required: true,\n                      disabled: disabled\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 144,\n                      columnNumber: 45\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 142,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"btn btn-primary\",\n                    disabled: disabled,\n                    children: \"Add to list\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 146,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: inputError ? inputError : \"\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 147,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 135,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 133,\n                columnNumber: 33\n              }, this), returnList.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"my-3\",\n                  children: \"Return Summary\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 151,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n                  className: \"table table-striped table-bordered\",\n                  children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                    children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                        scope: \"col\",\n                        children: \"Vaccine Name\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 155,\n                        columnNumber: 53\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        scope: \"col\",\n                        children: \"Vaccine  Batch Number \"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 156,\n                        columnNumber: 53\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        scope: \"col\",\n                        children: \"Vaccine  Quantity \"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 157,\n                        columnNumber: 53\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        scope: \"col\",\n                        children: \"Action \"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 158,\n                        columnNumber: 53\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 154,\n                      columnNumber: 49\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 153,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                    children: returnList.map((key, index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                        children: key.vaccineName\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 164,\n                        columnNumber: 69\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: key.batchNumber\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 164,\n                        columnNumber: 95\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: key.vaccineQuantity\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 164,\n                        columnNumber: 121\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: /*#__PURE__*/_jsxDEV(\"button\", {\n                          onClick: () => deleteReturn(index),\n                          className: \"btn btn-danger\",\n                          disabled: disabled,\n                          children: \"Delete\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 164,\n                          columnNumber: 155\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 164,\n                        columnNumber: 151\n                      }, this)]\n                    }, index, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 164,\n                      columnNumber: 53\n                    }, this))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 161,\n                    columnNumber: 45\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 152,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(Button, {\n                  variant: \"primary\",\n                  disabled: disabled,\n                  onClick: handleApiSubmission,\n                  children: [/*#__PURE__*/_jsxDEV(Spinner, {\n                    as: \"span\",\n                    animation: spin,\n                    size: \"sm\",\n                    role: \"status\",\n                    \"aria-hidden\": \"true\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 169,\n                    columnNumber: 45\n                  }, this), \" Submit\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 168,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 150,\n                columnNumber: 37\n              }, this) : \"\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 132,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 122,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Return, \"BdF6mW4wkoSerCwNAw+MxdHdjlY=\", false, function () {\n  return [useInput, useInput];\n});\n\n_c = Return;\nexport default Return;\n\nvar _c;\n\n$RefreshReg$(_c, \"Return\");","map":{"version":3,"sources":["/home/samuel/vmis-1/src/Pages/Return.js"],"names":["React","useContext","useState","useEffect","axios","useInput","Tabs","Tab","Button","Spinner","VaccineList","constraintCheck","userIntelContext","CardComponent","returnList","Return","props","config","method","url","headers","localStorage","getItem","user","value","quantity","bind","bindQuantity","reset","resetQuantity","batchNumber","bindBatchNumber","resetBatchNumber","disabled","setDisabled","spin","setSpin","message","setMessage","Deleted","setDeleted","returnMade","setReturnMade","myStock","setMyStock","selectedVaccine","setSelectedVaccine","inputError","setInputError","get","then","res","response","data","catch","e","console","log","handleSubmit","preventDefault","quantityCheck","key","hasOwnProperty","element","vaccineId","push","vaccineName","document","getElementById","deleteReturn","splice","setInterval","handleApiSubmission","from_orgunitid","userToken","orgunit","from_orgunitname","orgunitname","to_orgunitid","parentorgunit","to_orgunitname","parentorgunitname","returnedItems","JSON","stringify","post","length","type","setTimeout","vaccine","err","error","map","index","vaccineQuantity"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect } from 'react';\nimport axios from 'axios'\nimport { useInput } from '../Data/useInput';\nimport { Tabs, Tab, Button, Spinner } from 'react-bootstrap/'\nimport VaccineList from '../Components/VaccinesSelectDropDown'\nimport { constraintCheck } from '../Data/ConstraintCheck';\nimport { userIntelContext } from '../App';\nimport CardComponent from '../Components/CardComponent';\nlet returnList = []\nconst Return = (props) => {\n    var config = {\n        method: 'get',\n        url: 'http://localhost:8765/api/return',\n        headers: {\n            'auth': localStorage.getItem('vmisJwt')\n        }\n    };\n\n    const user = useContext(userIntelContext)\n    const { value: quantity, bind: bindQuantity, reset: resetQuantity } = useInput('');\n    const { value: batchNumber, bind: bindBatchNumber, reset: resetBatchNumber } = useInput('');\n    const [disabled, setDisabled] = useState(false)\n    const [spin, setSpin] = useState('')\n    const [message, setMessage] = useState('')\n    const [Deleted, setDeleted] = useState(false)\n    const [returnMade, setReturnMade] = useState(0)\n    const [myStock, setMyStock] = useState(null)\n    const [selectedVaccine, setSelectedVaccine] = useState('')\n    const [inputError, setInputError] = useState(null)\n    useEffect(() => {\n        axios.get('http://localhost:8765/api/dispense', { headers: config.headers }).then(res => {\n            setMyStock(res.response.data)\n        }).catch(e => {\n            console.log(e)\n        })\n    }, [message])\n    const handleSubmit = (e) => {\n        e.preventDefault()\n        let quantityCheck = null\n        for (const key in myStock) {\n            if (myStock.hasOwnProperty(key)) {\n                const element = myStock[key];\n                if (element.vaccineId===selectedVaccine.vaccineId) {\n                    if (element.quantity < quantity) {\n                        quantityCheck = 1;\n                    }\n                }\n            }\n        }\n        if (!quantityCheck) {\n            if (constraintCheck(returnList, selectedVaccine.vaccineId, quantity)) {\n                returnList = constraintCheck(returnList, selectedVaccine.vaccineId, quantity)\n            } else {\n                returnList.push({\n                    \"vaccineName\": selectedVaccine.vaccineName,\n                    \"vaccineid\": selectedVaccine.vaccineId,\n                    \"batchNumber\": batchNumber,\n                    \"vaccineQuantity\": quantity\n                })\n            }\n            document.getElementById(\"vaccineSelectionDropdown\").value = \"\";\n            resetQuantity()\n            resetBatchNumber()\n        }\n        else {\n            setInputError(\"quantity is greater than your stock\")\n        }\n    }\n    const deleteReturn = (e) => {\n        returnList.splice(e, 1)\n        setInterval(() => {\n            setDeleted(true)\n        }, 50);\n        setDeleted(false)\n    }\n    const handleApiSubmission = () => {\n        setSpin('border');\n        setDisabled(true);\n        const data = {\n            from_orgunitid: user.userToken.orgunit,\n            from_orgunitname: user.userToken.orgunitname,\n            to_orgunitid: user.userToken.parentorgunit,\n            to_orgunitname: user.userToken.parentorgunitname,\n            returnedItems: JSON.stringify(returnList)\n        }\n        axios.post(\"http://localhost:8765/api/return\", data, {\n            headers: {\n                'auth': localStorage.getItem('vmisJwt')\n            }\n        }).then(res => {\n            setDisabled(false)\n            setMessage('')\n            returnList.splice(0, returnList.length);\n            setSpin('');\n            setMessage({ message: 'Return was successfully', type: 'text-center alert alert-success m-2' });\n            setReturnMade(returnMade + 1)\n            setTimeout(() => {\n                setMessage('')\n            }, 3000);\n\n        }).catch(e => {\n            if (e.response.data) {\n                if (e.response.data[0].vaccine) {\n                    for (const err in e.response.data) {\n                        const error = e.response.data[err]\n                        setMessage({ message: `Return failed ${error.vaccine} ${error.error} `, type: 'text-center alert alert-danger m-2' });\n                    }\n                }\n                else {\n                    setMessage({ message: `Return failed `, type: 'text-center alert alert-danger m-2' });\n                }\n            }\n            setSpin('');\n            setDisabled(false);\n            setTimeout(() => {\n                setMessage('')\n            }, 5000);\n\n        })\n    }\n    return (\n        <div>\n            <h4 className='card-header text-center'>Return </h4>\n            <p className={message.type}>{message.message}</p>\n            <div className=\"container-fluid my-3\">\n                <Tabs defaultActiveKey=\"returns\" transition={false} id=\"noanim-tab-example\">\n                    <Tab eventKey=\"returns\" title=\"Returns\">\n                        <CardComponent dependency={returnMade} config={config} />\n                    </Tab>\n                    <Tab eventKey=\"returnForm\" title=\"Return Form\">\n                        <div className=\"container-fluid\">\n                            <div className=\"row\">\n                                <div className=\"col-6\">\n                                    <h3>Return Form</h3>\n                                    <form onSubmit={handleSubmit}>\n                                        <VaccineList onChange={value => setSelectedVaccine(value)} disabled={disabled} />\n                                        <div className=\"form-group\">\n                                            <label>Batch Number:</label>\n                                            <input type=\"text\" className=\"form-control\" placeholder=\"Batch number\" {...bindBatchNumber} required disabled={disabled} />\n\n                                        </div>\n                                        <div className=\"form-group\">\n                                            <label>Quantity:</label>\n                                            <input type=\"number\" className=\"form-control\" placeholder=\"Quantity to be returned\" {...bindQuantity} required disabled={disabled} />\n                                        </div>\n                                        <button className=\"btn btn-primary\" disabled={disabled}>Add to list</button>\n                                        <p>{inputError ? inputError : \"\"}</p>\n                                    </form>\n                                </div>{returnList.length > 0 ?\n                                    <div className=\"col-6\">\n                                        <h3 className=\"my-3\">Return Summary</h3>\n                                        <table className=\"table table-striped table-bordered\">\n                                            <thead>\n                                                <tr>\n                                                    <th scope=\"col\">Vaccine Name</th>\n                                                    <th scope=\"col\">Vaccine  Batch Number </th>\n                                                    <th scope=\"col\">Vaccine  Quantity </th>\n                                                    <th scope=\"col\">Action </th>\n                                                </tr>\n                                            </thead>\n                                            <tbody>\n                                                {returnList.map((key, index) => (\n\n                                                    <tr key={index}><td>{key.vaccineName}</td><td>{key.batchNumber}</td><td>{key.vaccineQuantity}</td><td><button onClick={() => deleteReturn(index)} className=\"btn btn-danger\" disabled={disabled}>Delete</button></td></tr>\n                                                ))}\n                                            </tbody>\n                                        </table>\n                                        <Button variant=\"primary\" disabled={disabled} onClick={handleApiSubmission}>\n                                            <Spinner as=\"span\" animation={spin} size=\"sm\" role=\"status\" aria-hidden=\"true\" /> Submit</Button>\n\n                                    </div> : \"\"}\n                            </div>\n                        </div>\n                    </Tab>\n                </Tabs>\n\n            </div>\n        </div>\n    );\n}\n\nexport default Return;"]},"metadata":{},"sourceType":"module"}